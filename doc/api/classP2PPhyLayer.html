<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Mobility Framework: P2PPhyLayer Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.4 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>P2PPhyLayer Class Reference<br>
<small>
[<a class="el" href="group__phyLayer.html">phyLayer - physical layer modules</a>]</small>
</h1><!-- doxytag: class="P2PPhyLayer" --><!-- doxytag: inherits="ChannelAccess" -->A very simple physical layer.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="P2PPhyLayer_8h-source.html">P2PPhyLayer.h</a>&gt;</code>
<p>
Inherits <a class="el" href="classChannelAccess.html">ChannelAccess</a>.
<p>
Inheritance diagram for P2PPhyLayer:<p><center><img src="classP2PPhyLayer__inherit__graph.png" border="0" usemap="#P2PPhyLayer__inherit__map" alt="Inheritance graph"></center>
<map name="P2PPhyLayer__inherit__map">
<area href="classChannelAccess.html" shape="rect" coords="7,158,122,182" alt="">
<area href="classBasicModule.html" shape="rect" coords="15,83,114,107" alt="">
<area href="classImNotifiable.html" shape="rect" coords="19,9,110,33" alt="">
</map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center>Collaboration diagram for P2PPhyLayer:<p><center><img src="classP2PPhyLayer__coll__graph.png" border="0" usemap="#P2PPhyLayer__coll__map" alt="Collaboration graph"></center>
<map name="P2PPhyLayer__coll__map">
<area href="classChannelAccess.html" shape="rect" coords="255,214,370,238" alt="">
<area href="classBasicModule.html" shape="rect" coords="94,113,193,137" alt="">
<area href="classImNotifiable.html" shape="rect" coords="7,9,98,33" alt="">
<area href="classBlackboard.html" shape="rect" coords="122,9,210,33" alt="">
<area href="classHostMove.html" shape="rect" coords="355,113,435,137" alt="">
<area href="classBBItem.html" shape="rect" coords="471,9,538,33" alt="">
<area href="classActiveChannel.html" shape="rect" coords="471,163,581,187" alt="">
<area href="classCoord.html" shape="rect" coords="298,9,357,33" alt="">
<area href="classChannelControl.html" shape="rect" coords="217,113,331,137" alt="">
</map>
<center><font size="2">[<a target="top" href="graph_legend.html">legend</a>]</font></center><a href="classP2PPhyLayer-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a0"></a><!-- doxytag: member="P2PPhyLayer::Module_Class_Members" ref="a0" args="(P2PPhyLayer, ChannelAccess, 0)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>Module_Class_Members</b> (<a class="el" href="classP2PPhyLayer.html">P2PPhyLayer</a>, <a class="el" href="classChannelAccess.html">ChannelAccess</a>, 0)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#a1">initialize</a> (int)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialization of the module and some variables.  <a href="#a1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a2"></a><!-- doxytag: member="P2PPhyLayer::finish" ref="a2" args="()" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><b>finish</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#a3">handleMessage</a> (cMessage *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called every time a message arrives.  <a href="#a3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a4"></a><!-- doxytag: member="P2PPhyLayer::receiveBBItem" ref="a4" args="(int category, const BBItem *details, int scopeModuleId)" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#a4">receiveBBItem</a> (int category, const <a class="el" href="classBBItem.html">BBItem</a> *details, int scopeModuleId)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called by the <a class="el" href="classBlackboard.html">Blackboard</a> whenever a change occurs we're interested in. <br></td></tr>
<tr><td colspan="2"><br><h2>Protected Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#x1">P2PPhyKinds</a> { <b>RECEPTION_COMPLETE</b> =  1350101811
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The kind field of messages.  <a href="classP2PPhyLayer.html#x1">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#b0">calcDuration</a> (cMessage *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function calculates the duration of the AirFrame.  <a href="#b0"></a><br></td></tr>
<tr><td colspan="2"><div class="groupHeader">Handle Messages</div></td></tr>
<tr><td colspan="2"><div class="groupText">Functions to redefine by the programmer<p>
These are the functions provided to add own functionality to your modules. These functions are called whenever a blackboard message, a self message or a data message from the upper or lower layer arrives respectively.<br><br></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#z7_0">handleSelfMsg</a> (cMessage *msg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle self messages such as timer...  <a href="#z7_0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#z7_1">handleUpperMsg</a> (AirFrame *, int)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle messages from upper layer.  <a href="#z7_1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#z7_2">handleLowerMsg</a> (AirFrame *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle messages from lower layer.  <a href="#z7_2"></a><br></td></tr>
<tr><td colspan="2"><div class="groupHeader">Convenience Functions</div></td></tr>
<tr><td colspan="2"><div class="groupText">Functions for convenience - NOT to be modified<p>
These are functions taking care of message encapsulation and message sending. Normally you should not need to alter these but should use them to handle message encasulation and sending. They will wirte all necessary information into packet headers and add or strip the appropriate headers for each layer.<br><br></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">AirFrame *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#z8_0">encapsMsg</a> (cMessage *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Encapsulate the MacPkt into an AirFrame.  <a href="#z8_0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#z8_1">bufferMsg</a> (AirFrame *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Buffer message upon reception.  <a href="#z8_1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">AirFrame *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#z8_2">unbufferMsg</a> (cMessage *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unbuffer message after it is completely received.  <a href="#z8_2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#z8_3">sendP2P</a> (AirFrame *, int)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends a unicast message; waits delay seconds before sending.  <a href="#z8_3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#z8_4">sendDown</a> (AirFrame *, int)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends a message to the channel; waits delay seconds before sending.  <a href="#z8_4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#z8_5">sendUp</a> (AirFrame *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends a message to the upper layer; waits delay seconds before sending.  <a href="#z8_5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#z8_6">sendDelayedP2P</a> (AirFrame *, double, int)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends a unicast message.  <a href="#z8_6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#z8_7">sendDelayedDown</a> (AirFrame *, double, int)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends a message to the channel.  <a href="#z8_7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#z8_8">sendDelayedUp</a> (AirFrame *, double)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends a message to the upper layer.  <a href="#z8_8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#z8_9">sendControlUp</a> (cMessage *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends a control message to the upper layer.  <a href="#z8_9"></a><br></td></tr>
<tr><td colspan="2"><div class="groupHeader">Abstraction layer</div></td></tr>
<tr><td colspan="2"><div class="groupText">Factory function to create AirFrame into which a MAC frame is encapsulated.<p>
<a class="el" href="classSnrEval.html">SnrEval</a> authors should be able to use their own <a class="el" href="classSnrEval.html">SnrEval</a> packets. The framework does not need to know about them, but must be able to produce new ones. Both goals can be reached by using a factory method.<p>
Overwrite this function in derived classes to use your own AirFrames<br><br></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="z9_0"></a><!-- doxytag: member="P2PPhyLayer::createCapsulePkt" ref="z9_0" args="()" -->
virtual AirFrame *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#z9_0">createCapsulePkt</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a new AirFrame. <br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p0"></a><!-- doxytag: member="P2PPhyLayer::bitrate" ref="p0" args="" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#p0">bitrate</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">bitrate read from omnetpp.ini <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#p1">headerLength</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">length of the AirFrame header  <a href="#p1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p2"></a><!-- doxytag: member="P2PPhyLayer::pBit" ref="p2" args="" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#p2">pBit</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">bit error rate (including all other loss possibilities for message losses) <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p3"></a><!-- doxytag: member="P2PPhyLayer::transmitterPower" ref="p3" args="" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#p3">transmitterPower</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">power used to transmit messages <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p4"></a><!-- doxytag: member="P2PPhyLayer::txOverTimer" ref="p4" args="" -->
cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#p4">txOverTimer</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Timer to indicate the end of a transmission to a higher layer. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p5"></a><!-- doxytag: member="P2PPhyLayer::channel" ref="p5" args="" -->
<a class="el" href="classActiveChannel.html">ActiveChannel</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#p5">channel</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Currently active channel, set using radio, updated via BB. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="p6"></a><!-- doxytag: member="P2PPhyLayer::catActiveChannel" ref="p6" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#p6">catActiveChannel</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">category number given by bb for <a class="el" href="classActiveChannel.html">ActiveChannel</a> <br></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="z6_0"></a><!-- doxytag: member="P2PPhyLayer::uppergateOut" ref="z6_0" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#z6_0">uppergateOut</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">gate ids <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="z6_1"></a><!-- doxytag: member="P2PPhyLayer::uppergateIn" ref="z6_1" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#z6_1">uppergateIn</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">gate ids <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="z6_2"></a><!-- doxytag: member="P2PPhyLayer::upperControlOut" ref="z6_2" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classP2PPhyLayer.html#z6_2">upperControlOut</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">gate ids <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
A very simple physical layer. 
<p>
This is the simplest physical layer you can think of.<p>
It decides upon one simple parameter <a class="el" href="classP2PPhyLayer.html#p2">pBit</a> (bit error rate) about the correctness of a frame. Collisions, bit errors, interference and anything else you can think of are combined in this single parameter.<p>
<dl compact><dt><b>Author:</b></dt><dd>Marc Loebbers, Daniel Willkomm</dd></dl>

<p>
<hr><h2>Member Enumeration Documentation</h2>
<a class="anchor" name="x1"></a><!-- doxytag: member="P2PPhyLayer::P2PPhyKinds" ref="x1" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">enum <a class="el" href="classP2PPhyLayer.html#x1">P2PPhyLayer::P2PPhyKinds</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The kind field of messages. 
<p>
that are used internally by this class have one of these values    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="z8_1"></a><!-- doxytag: member="P2PPhyLayer::bufferMsg" ref="z8_1" args="(AirFrame *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void P2PPhyLayer::bufferMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">AirFrame *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>frame</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Buffer message upon reception. 
<p>
The packet is put in a buffer for the time the transmission would last in reality. A timer indicates when the transmission is complete. So, look at unbufferMsg to see what happens when the transmission is complete..    </td>
  </tr>
</table>
<a class="anchor" name="b0"></a><!-- doxytag: member="P2PPhyLayer::calcDuration" ref="b0" args="(cMessage *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double P2PPhyLayer::calcDuration           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>af</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function calculates the duration of the AirFrame. 
<p>
Usually the duration is just the frame length divided by the bitrate. However there may be cases (like 802.11) where the header has a different modulation (and thus a different bitrate) than the rest of the message.<p>
Just redefine this function in such a case!    </td>
  </tr>
</table>
<a class="anchor" name="z8_0"></a><!-- doxytag: member="P2PPhyLayer::encapsMsg" ref="z8_0" args="(cMessage *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">AirFrame * P2PPhyLayer::encapsMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Encapsulate the MacPkt into an AirFrame. 
<p>
Encapsulate the received MacPkt into an AirFrame and set all needed header fields.<p>
<dl compact><dt><b>See also:</b></dt><dd>AirFrame</dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="z7_2"></a><!-- doxytag: member="P2PPhyLayer::handleLowerMsg" ref="z7_2" args="(AirFrame *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void P2PPhyLayer::handleLowerMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">AirFrame *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle messages from lower layer. 
<p>
Redefine this function if you want to process messages from the channel before they are forwarded to upper layers<p>
This basic implementation just checks whether a received packet had errors. Decision depends only on <a class="el" href="classP2PPhyLayer.html#p2">pBit</a> (defined in omnetppp.ini) and the message length. The length field is assumed to be in bits.<p>
If you want to forward the message to upper layers please use <a class="el" href="classP2PPhyLayer.html#z8_5">sendUp</a> which will decapsulate the MacPkt before sending    </td>
  </tr>
</table>
<a class="anchor" name="a3"></a><!-- doxytag: member="P2PPhyLayer::handleMessage" ref="a3" args="(cMessage *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void P2PPhyLayer::handleMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Called every time a message arrives. 
<p>
The basic handle message function.<p>
Depending on the gate a message arrives handleMessage just calls different handle*Msg functions to further process the message.<p>
Messages from the channel are also buffered here in order to simulate a transmission delay<p>
You should not make any changes in this function but implement all your functionality into the handle*Msg functions called from here.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="classP2PPhyLayer.html#z7_1">handleUpperMsg</a>, <a class="el" href="classP2PPhyLayer.html#z7_2">handleLowerMsg</a>, <a class="el" href="classP2PPhyLayer.html#z7_0">handleSelfMsg</a></dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="z7_0"></a><!-- doxytag: member="P2PPhyLayer::handleSelfMsg" ref="z7_0" args="(cMessage *msg)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual void P2PPhyLayer::handleSelfMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle self messages such as timer... 
<p>
Define this function if you want to timer or other kinds of self messages    </td>
  </tr>
</table>
<a class="anchor" name="z7_1"></a><!-- doxytag: member="P2PPhyLayer::handleUpperMsg" ref="z7_1" args="(AirFrame *, int)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void P2PPhyLayer::handleUpperMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">AirFrame *&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dest</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle messages from upper layer. 
<p>
Redefine this function if you want to process messages from upper layers before they are send to the channel.<p>
The MacPkt is already encapsulated in an AirFrame and all standard header fields are set.<p>
To forward the message to lower layers after processing it please use <a class="el" href="classP2PPhyLayer.html#z8_4">sendDown</a>. It will take care of decapsulation and anything else needed<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dest</em>&nbsp;</td><td>Destination nic module id() in order to find the destination gate for sending the message</td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="a1"></a><!-- doxytag: member="P2PPhyLayer::initialize" ref="a1" args="(int)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void P2PPhyLayer::initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>stage</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialization of the module and some variables. 
<p>
First we have to initialize the module from which we derived ours, in this case <a class="el" href="classChannelAccess.html">ChannelAccess</a>.<p>
Then we have to intialize the gates and - if necessary - some own variables.
<p>
Reimplemented from <a class="el" href="classChannelAccess.html#a0">ChannelAccess</a>.    </td>
  </tr>
</table>
<a class="anchor" name="z8_9"></a><!-- doxytag: member="P2PPhyLayer::sendControlUp" ref="z8_9" args="(cMessage *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void P2PPhyLayer::sendControlUp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends a control message to the upper layer. 
<p>
send a control message to the upper layer    </td>
  </tr>
</table>
<a class="anchor" name="z8_7"></a><!-- doxytag: member="P2PPhyLayer::sendDelayedDown" ref="z8_7" args="(AirFrame *, double, int)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void P2PPhyLayer::sendDelayedDown           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">AirFrame *&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>delay</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dest</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends a message to the channel. 
<p>
For this special case the sending of the message as broadcast and unicast messages are handled differently.<p>
This function is only for convenience so that the programmer does not have to take care about the details of message sending<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dest</em>&nbsp;</td><td>Destination nic module id() in order to find the destination gate for sending the message</td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="z8_6"></a><!-- doxytag: member="P2PPhyLayer::sendDelayedP2P" ref="z8_6" args="(AirFrame *, double, int)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void P2PPhyLayer::sendDelayedP2P           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">AirFrame *&nbsp;</td>
          <td class="mdname" nowrap> <em>frame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>delay</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dest</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends a unicast message. 
<p>
Finds the destination gate of the recipient and sends the message only via the link which is connected to that gate..<p>
This function is only used for the point-to-point sending and thus the specialily of the P2P network.<p>
Although the wireless channel is a broadcast channel and all hosts within interference distance should receive all messages sendP2P sends a message directly via unicast to the desired destination.<p>
This is only possible because we do not assume lost messages due to interference or collitions. All possible message losses are summed up in one parameter <a class="el" href="classP2PPhyLayer.html#p2">pBit</a>.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="classChannelControl.html#a6">ChannelControl::getOutGateTo()</a></dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="z8_8"></a><!-- doxytag: member="P2PPhyLayer::sendDelayedUp" ref="z8_8" args="(AirFrame *, double)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void P2PPhyLayer::sendDelayedUp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">AirFrame *&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>delay</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends a message to the upper layer. 
<p>
decapsulate message and send it to the upper layer.<p>
to be called within <a class="el" href="classP2PPhyLayer.html#z7_2">handleLowerMsg</a>.    </td>
  </tr>
</table>
<a class="anchor" name="z8_4"></a><!-- doxytag: member="P2PPhyLayer::sendDown" ref="z8_4" args="(AirFrame *, int)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void P2PPhyLayer::sendDown           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">AirFrame *&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dest</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends a message to the channel; waits delay seconds before sending. 
<p>
Convenience function which calls sendDelayedDown with delay set to 0.0.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="classP2PPhyLayer.html#z8_7">sendDelayedDown</a></dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="z8_3"></a><!-- doxytag: member="P2PPhyLayer::sendP2P" ref="z8_3" args="(AirFrame *, int)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void P2PPhyLayer::sendP2P           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">AirFrame *&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dest</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends a unicast message; waits delay seconds before sending. 
<p>
Convenience function which calls sendDelayedP2P with delay set to 0.0.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="classP2PPhyLayer.html#z8_6">sendDelayedP2P</a></dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="z8_5"></a><!-- doxytag: member="P2PPhyLayer::sendUp" ref="z8_5" args="(AirFrame *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void P2PPhyLayer::sendUp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">AirFrame *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends a message to the upper layer; waits delay seconds before sending. 
<p>
Convenience function which calls sendDelayedUp with delay set to 0.0.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="classP2PPhyLayer.html#z8_8">sendDelayedUp</a></dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="z8_2"></a><!-- doxytag: member="P2PPhyLayer::unbufferMsg" ref="z8_2" args="(cMessage *)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">AirFrame * P2PPhyLayer::unbufferMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">cMessage *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Unbuffer message after it is completely received. 
<p>
Get the context pointer to the now completely received AirFrame and delete the self message    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="p1"></a><!-- doxytag: member="P2PPhyLayer::headerLength" ref="p1" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="classP2PPhyLayer.html#p1">P2PPhyLayer::headerLength</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
length of the AirFrame header 
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>for now it is read from omnetpp.ini but should be easily settable by the user later </dd></dl>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="P2PPhyLayer_8h-source.html">P2PPhyLayer.h</a><li>P2PPhyLayer.cc</ul>
<hr size="1"><address style="align: right;"><small>Generated on Fri Jan 12 08:30:12 2007 for Mobility Framework by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.4 </small></address>
</body>
</html>
